<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/lfr-forms-docs/styles.75105c92a002ae2b4b8d.css">code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;padding:0;margin:0 0 1.45rem}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}.chapter-link a{color:#272833;text-decoration:none}.chapter-link a:visited{color:#6b6c7e;text-decoration:none}.chapter-link .chapter-index{font-size:150%}.table-of-contents{padding:2rem 0}.table-of-contents-chapter{margin-bottom:2rem}.table-of-contents .chapter-link{font-size:125%}.table-of-contents .chapter-description{padding-left:1rem}</style><meta name="generator" content="Gatsby 2.20.12"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><title data-react-helmet="true">Table of Contents | Liferay Forms - Documentação</title><meta data-react-helmet="true" name="description" content="Documentação da arquitetura utilizada para implementar o Liferay Forms."/><meta data-react-helmet="true" property="og:title" content="Table of Contents"/><meta data-react-helmet="true" property="og:description" content="Documentação da arquitetura utilizada para implementar o Liferay Forms."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@liferay"/><meta data-react-helmet="true" name="twitter:title" content="Table of Contents"/><meta data-react-helmet="true" name="twitter:description" content="Documentação da arquitetura utilizada para implementar o Liferay Forms."/><link rel="icon" href="/lfr-forms-docs/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="manifest" href="/lfr-forms-docs/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/lfr-forms-docs/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="72x72" href="/lfr-forms-docs/icons/icon-72x72.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="96x96" href="/lfr-forms-docs/icons/icon-96x96.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="144x144" href="/lfr-forms-docs/icons/icon-144x144.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="192x192" href="/lfr-forms-docs/icons/icon-192x192.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="256x256" href="/lfr-forms-docs/icons/icon-256x256.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="384x384" href="/lfr-forms-docs/icons/icon-384x384.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="512x512" href="/lfr-forms-docs/icons/icon-512x512.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link as="script" rel="preload" href="/lfr-forms-docs/webpack-runtime-5c83b0c36b95088ee901.js"/><link as="script" rel="preload" href="/lfr-forms-docs/framework-624f79e66261973aaa49.js"/><link as="script" rel="preload" href="/lfr-forms-docs/app-a11bf876fdf1e027fbc6.js"/><link as="script" rel="preload" href="/lfr-forms-docs/styles-36681512479a843831b0.js"/><link as="script" rel="preload" href="/lfr-forms-docs/commons-41607989188aa9047a31.js"/><link as="script" rel="preload" href="/lfr-forms-docs/component---src-pages-index-js-ee47f98d5429b2dd3b85.js"/><link as="fetch" rel="preload" href="/lfr-forms-docs/page-data/index/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/lfr-forms-docs/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header style="background:#30313f;color:#6B6C7E;margin-bottom:1.45rem"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem"><h1 style="margin:0"><a aria-current="page" style="color:white;text-decoration:none" class="" href="/lfr-forms-docs/">Liferay Forms - Documentação</a></h1></div></header><div style="margin:0 auto;max-width:960px;padding:0 1.0875rem 1.45rem"><main><div class="chapter"><h1 style="font-size:50px">Introdução</h1><div class="chapter-content"><h1 id="o-que-esperar-desse-documento" style="position:relative;"><a href="#o-que-esperar-desse-documento" aria-label="o que esperar desse documento permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>O que esperar desse documento?</h1>
<p>A idéia desse documento é servir como guia introdutório para desenvolvedores que precisem implementar novas features, bug fixes e improvements no código do Forms.</p>
<p>Pretendemos explicar como a implemetação do Front End do Forms é organizada. Tentaremos detalhar algumas técnicas e explicar como os padrões de projetos utilizados foram aplicados no contexto da aplicação, tentando sempre mostrar exemplos de códigos para facilitar o entendimento.</p>
<p>Não é a intenção desse documento ensinar sintaxe JavaScript ou ser um curso detalhado sobre os padrões ou framework utilizados. Colocaremos links como referência sempre que necessário.</p>
<p>Mas antes, vamos contar um pouco sobre a <a href="/history">história</a> do projeto para que você possa entender melhor o que aconteceu até chegarmos ao estado atual.</p></div></div><div class="chapter"><h1 style="font-size:50px">História</h1><div class="chapter-content"><h1 id="da-onde-veio-o-forms" style="position:relative;"><a href="#da-onde-veio-o-forms" aria-label="da onde veio o forms permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Da onde veio o Forms?</h1>
<p>O portlet de Forms que temos hoje no Liferay DXP é um reflexo de evoluções e adaptações de soluções mais antigas desenvolvidas pela Liferay. Em meados de 2010, Michael Han percebeu nos nossos clientes a necesidade de se adaptar o banco de dados do Liferay para suportar customizações que eram muito comuns ao se implantar um sistema com Liferay. Baseado nessa necessidade, ele idealizou um sistema onde um usuário poderia modelar um banco de dados utilizando a própria UI do Liferay sem a necessidade de programação ou de alterar o banco de dados do próprio Liferay através de SQL.</p>
<p>Esse sistema recebeu o nome de Dynamic Data Lists. Com ele veio a <a href="https://github.com/liferay/alloy-ui/commit/99b3c5d0d09c1867e8b9962ea4fe95f383611b07#diff-ef9f2ea7373eb89698ac6953359e5a8d">primeira implementação de um Form Builder pela Liferay</a>. Um componente que se utlizava de Drag and Drop onde o usuário poderia arrastar os campos do banco de dados que desejava criar. A implementação foi feita utilizando o framework adotado pela Liferay na época: <a href="http://alloyui.com/">AlloyUI</a>.</p>
<h1 id="tá-e-o-que-aconteceu-de-lá-pra-cá" style="position:relative;"><a href="#t%C3%A1-e-o-que-aconteceu-de-l%C3%A1-pra-c%C3%A1" aria-label="tá e o que aconteceu de lá pra cá permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tá! E o que aconteceu de lá pra cá?</h1>
<p>Desde o começo de sua implementação em Janeiro de 2011 (há mais de 9 anos atrás), o Form Builder passou por vários ciclos de bug fixing, melhorias e reescritas. Por volta de 2014 ele foi reescrito ainda em AlloyUI para suportar <strong>Layouts</strong>: Uma feature que permitia que o usuário criasse um formulário com multiplas <strong>linhas e colunas</strong>. Nessa época a Liferay Brasil tinha acabado de contratar seus primeiros designers e aproveitou essa reescrita para fazer melhorias na UI. Uma dessas "melhorias" foi a <strong>remoção do Drag and Drop</strong> porque alguns feedbacks sobre o produto diziam que ele tornava a aplicação muito complexa.</p>
<p>Essa remoção acabou não sendo muito bem aceita pelos usuários do produto e algum tempo depois, o <strong>Drag and Drop foi adicionado novamente</strong>. Adicionar o Drag and Drop de volta dessa vez não foi tão trivial porque o Form Builder tinha sido reescrito sem esse requisito em mente.</p>
<p>E o Form Builder ficou nesse estado durante um bom tempo. Algumas melhorias foram sendo implementadas aos poucos, mas a maiora das mudanças eram bug fixes. Nessa época o departamento de Front End da empresa estava focada na construção de um novo framework para se desenvolver aplicações, pois o <strong>AlloyUI estava depreciado</strong> (porque o framework em cima do qual ele foi construido foi depreciado).</p>
<p><strong>A Liferay lançou seu novo framwork - o <a href="/metal">Metal.js</a> -</strong> por volta de 2016 e foi migrando todos os portlets para usar esse framework aos poucos. Após algum tempo, AlloyUI dentro do portal era a minoria e o Form Builder era uma deles. O time de Front End Infrastructure começou a pressionar para a remoção de todo código que utilizasse AlloyUI do portal. Por volta de 2018 o time conseguiu convencer o gerente de produto de que era necessário investir algum tempo para modernizar o código, já que ter um produto feito em cima de um framework que não era mais mantido era um risco.</p>
<p>Foi então que a impementação que temos hoje começou a ser feita. O prazo era curto e a aplicação já tinhas muitos anos de história (requerimentos e edge cases a serem tratados). Uma das grandes dificuldades era que não existia padrão em vigor para se desenvolver aplicações do porte do Forms em metal. O próprio time teve que pensar em alguma forma de gerenciar estado de uma forma que fosse organizada e escalável. Mais a frente vamos ver como o <a href="/boomerang">Efeito Boomerang</a> foi concebido para resolver este problema.</p>
<h1 id="resumo-da-ópera" style="position:relative;"><a href="#resumo-da-%C3%B3pera" aria-label="resumo da ópera permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resumo da ópera</h1>
<p>Essa história toda é pra dizer que o Forms é uma aplicação complexa, com muita bagagem histórica e várias reescritas por pessoas diferentes e às vezes sem muito conhecimento das ferramentas (porque essas ferramentas não viveram o suficiente para serem bem documentadas). Isso faz com que o código possa não fazer sentido muitas vezes, mas o intuito desse documento é justamente tentar esclarecer o que estiver sombrio :)</p></div></div><div class="chapter"><h1 style="font-size:50px">Visão Alto Nível da Aplicação</h1><div class="chapter-content"><p>Pode-se distinguir 3 principais partes do Forms: A <a href="#user-view">User View</a>: parte que somente renderiza os formulários, <a href="#form-builder-view">Form Builder</a>: parte que cuida da criação desses formulários, assim como a Sidebar e a <a href="#rule-builder-view">Rule Builder View</a>: que toma de conta do criador de regras.</p>
<h1 id="user-view" style="position:relative;"><a href="#user-view" aria-label="user view permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>User View</h1>
<p>O User View é a parte da aplicação que é apresentada para o usuário final. Lá, o formulário que foi criado no <a href="#form-builder-view">Form Builder</a> é renderizado para o usuário: Todos os fields são renderizados seguindo o layout montado e as regras definidas no <a href="#rule-builder-view">Rule Builder View</a>, bem como as regras de validação de valores são executadas caso o usuário altere algum field gerenciado por alguma regra.</p>
<p>Não existe muito o que dizer sobre essa parte, ela é uma parte representacional da estrutura de um formulário montada previamente pelo <a href="#form-builder-view">Form Builder</a> e o <a href="#rule-builder-view">Rule Builder View</a>.</p>
<h1 id="form-builder-view" style="position:relative;"><a href="#form-builder-view" aria-label="form builder view permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Form Builder View</h1>
<p>Basicamente o Form Builder permite ao usuário montar como será o <strong>layout</strong> dos fields exibidos no User View. Nele fica o componente de Sidebar que permite a adição de fields ao formulário via <strong>Drag and Drop</strong> e também permite a configuração de properiedades de um field - caso ele esteja selecionado.</p>
<p>Uma curiosidade sobre a <strong>Sidebar</strong> é que o formulário usado para configurar as propriedades de um Field é na verdade uma espécie de User View: Lá é uasada a própria API do Forms para renderizar aquele formulário e, caso aquele form tenha regras, elas serão executadas. Entraremos em mais detalhes sobre isso mais a frente. Por agora é suficiente saber que a <strong>Sidebar usa a mesma API de renderização do Forms para rendrizar fields dentro dela</strong>.</p>
<h1 id="rule-builder-view" style="position:relative;"><a href="#rule-builder-view" aria-label="rule builder view permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rule Builder View</h1>
<p>O Rule Builder é a ferramenta que permite aos usuários adicionar comportamento aos formulários. É muito comum ao se criar formulários que o preenchimento de um field dependa de alguma condição (como o valor de outro field).</p>
<p>Tomemos como exemplo o seguinte formulário:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 764px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a2a3dd2d20b5ae97a01172ad0d38911a/f3c12/rules_example_01.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAABkUlEQVQ4y6VUiW7CMAzt//8dmgTdEIJRoPcReiW93uxo7YpGaYFIT0ld58X2c2LgidF13ayPUZYlrNMZh8M3LOsE1/VwPl9wudjYk41xov9N0wykPfG9A4yqqvTm49GCbTsIghCe5+uZ7WxzHBdt2y6K1uAfvXPbdhpN02obr3kfz3wwQyk1+E9G6HoB4ljA9yPEiaC0AwRhTLOv7SGtozjRs217RFxPpm/ghdETcaRjQoZxz3EKS9Q3pJRYr03sdvvJTb3dcWyYpontdofN5hOr1YfuipsIWYAwShBFAkUpCeoPhURdNwOxLyrYfoqY/IMg1jVlDW4JqQ7iWiC55iRIiugXvA6jK0qp+jhR0FLSfu7Jqmq0+v9S5g+pKkjy1PMYZOMM+tEyEdlzirykbLKsoDaqpkWZKzqryiVgEqVqOlANBw6Ec8o+umZ3VR5/LCGfg06Zizy+Tm8Rsuym+QUhxOIn6uHzxZGlaY4sL7V6r4J7lttIN3YiMt13r4L7ljk4OC2KotfjXfALtLgPnxk/ZMAhs0izGDEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Formulário de Cadastro de Clientes"
        title="Formulário de Cadastro de Clientes"
        src="/static/a2a3dd2d20b5ae97a01172ad0d38911a/f3c12/rules_example_01.png"
        srcset="/static/a2a3dd2d20b5ae97a01172ad0d38911a/772e8/rules_example_01.png 200w,
/static/a2a3dd2d20b5ae97a01172ad0d38911a/e17e5/rules_example_01.png 400w,
/static/a2a3dd2d20b5ae97a01172ad0d38911a/f3c12/rules_example_01.png 764w"
        sizes="(max-width: 764px) 100vw, 764px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Caso o usuário responda que é estrangeiro, o campo de CPF passa a não fazer mais sentido. O Rule Builder permite montar uma regra que esconde o campo <em>CPF</em> caso o campo <em>Nacionalidade</em> não seja igual a "Brasileiro".</p>
<h1 id="resumindo" style="position:relative;"><a href="#resumindo" aria-label="resumindo permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resumindo</h1>
<p>É isso. Falamos um pouco sobre as 3 principais partes da aplicação sem entrar em detalhes sobre a implementação. Nas próximas partes vamos ver um pouco de teoria e padrões de projeto que nos ajidarão a entender como essa aplicação foi construida.</p></div></div><div class="chapter"><h1 style="font-size:50px">Padrão de Projeto: Observer</h1><div class="chapter-content"><h1 id="o-que-esse-padrão-resolve" style="position:relative;"><a href="#o-que-esse-padr%C3%A3o-resolve" aria-label="o que esse padrão resolve permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>O que esse padrão resolve?</h1>
<p>Bem, o padrão observer é um design pattern em que um objeto contém uma lista de dependências chamadas observers e as notifica automaticamente assim que qualquer estado muda.</p>
<p>Esse padrão é implementado amplamente em sistemas de event handling. O padrão observer é o mais utilizado em bibliotecas e sistemas, utilizado quase que em qualquer pedaço de software escrito por pessoas que cuidam do frontend.</p>
<p>Segue abaixo um exemplo do uso desse padrão no Forms:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Dentro de um componente você encontrará provavelmente uma função que irá escutar(uma função de handler) determinado evento da aplicação como `fieldEdited` como:</span>

<span class="token keyword">function</span> <span class="token function">handleFieldEdited</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>‘data <span class="token keyword">from</span> fieldEdited event<span class="token operator">:</span> ’<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>‘fieldEdited’<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleFieldEdited</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// Assim como em outra parte da aplicação, terá algo emitindo o evento de `fieldEdited` com alguma informação, como:</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span>‘fieldEdited’<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		field<span class="token operator">:</span> ‘fieldinho_12323132’<span class="token punctuation">,</span>
		value<span class="token operator">:</span> ‘test’<span class="token punctuation">,</span>
		originalEvent<span class="token operator">:</span> <span class="token operator">&lt;</span>NativeEvent<span class="token operator">></span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// Ao emitir utilizando essa função, todos os componentes que estão escutando o evento de `fieldEdited` irão ser disparados.</span></code></pre></div>
<p>** Para melhor compreensão, nossos EventEmitters/funções <code class="language-text">emit</code> são nossos Publishers e as nossas funções <code class="language-text">on</code> são nossos Subscribers. **</p>
<h1 id="quais-formas-de-lidar-com-eventos-que-temos-no-forms" style="position:relative;"><a href="#quais-formas-de-lidar-com-eventos-que-temos-no-forms" aria-label="quais formas de lidar com eventos que temos no forms permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Quais formas de lidar com eventos que temos no Forms?</h1>
<ul>
<li>Utilizando o <code class="language-text">metal-dom</code>, utilizando <code class="language-text">dom.on</code>, para lidar com eventos da DOM nativos. Por exemplo adicionar determinado evento do browser como ‘scroll’ num componente.</li>
<li>Utilizando o <code class="language-text">metal-events</code>, nos componentes de Metal.js, essa implementação é sempre é usada e contém vários utilitários para se inscrever e emitir eventos. Um benefício é podemos criar nosso próprio evento, como <code class="language-text">fieldEdited</code>, que não é padrão do browser.
<a href="https://github.com/metal/metal.js/tree/master/packages/metal-events">metal.js/packages/metal-events at master · metal/metal.js · GitHub</a></li>
<li>Nas partes que utilizam React, é usada a maneira padrão do React e quando necessário, passado alguma função de metal-events via props ou por Adapter para escutar/emitir eventos.</li>
</ul>
<p>O padrão Observer pode causar vários vazamentos de memória, conhecidos como: <a href="https://en.wikipedia.org/wiki/Lapsed_listener_problem">Lapsed listener problem - Wikipedia</a>, em que se não forem removidos todos os listeners ao remover algum componente, podemos deixar vários listeners atachados no browser que não estão sendo mais utilizados e fazer com que o número de funções chamadas quando determinado componente for chamado cresça de forma exponencial.</p>
<p>Tanto o Metal quanto o React, conseguem remover os event listeners que foram adicionados por eles durante a etapa de destruição do componente. Entretanto, ao utilizar os métodos de lidar com eventos do <code class="language-text">metal-dom</code>, para tratar de eventos na DOM, se faz necessário chamar o método this.${variável<em>do</em>meu<em>event</em>handler}.removeAllListeners() no Lifecycle da etapa de desconstrução do componente(disposed).</p></div></div><div class="chapter"><h1 style="font-size:50px">Single Source of Truth (SSOT)</h1><div class="chapter-content"><h1 id="single-source-of-truth-ssot" style="position:relative;"><a href="#single-source-of-truth-ssot" aria-label="single source of truth ssot permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Single Source of Truth (SSOT)</h1>
<h3 id="apresentação-do-problema" style="position:relative;"><a href="#apresenta%C3%A7%C3%A3o-do-problema" aria-label="apresentação do problema permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Apresentação do problema</h3>
<p>Quando você começa a ter uma ideia de ter um estado dentro de cada componente parece tudo muito mais organizado né?! Isso faz com que todas as funcionalidades e dados sejam mantidas e possam ser usadas dentro de um único objeto.</p>
<p>O conceito de se ter um estado é ótimo porque assim conseguimos isolar coisas e fazer com que possamos quebrar aplicações grandes em pequenos pedacinhos reutilizáveis. Entretanto em algum ponto isso se torna um pouco complicado e irão surgir dúvidas como: “Onde os dados estão guardados?”; Se esses dados são duplicados, como teremos certeza que ao alterar um dado, todos os lugares onde estarão usando esse dado serão atualizados? Dentro do contexto do Forms, onde há dezenas(centenas?) de componentes isso pode se tornar o caos.</p>
<h3 id="solução-do-problema" style="position:relative;"><a href="#solu%C3%A7%C3%A3o-do-problema" aria-label="solução do problema permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Solução do problema</h3>
<p>A solução foi pegar uma ideia bastante difundida na comunidade de React chamada “Single Source of Truth”, em que existe um estado “pai de todos” para que todos os seus valores sejam refletidos em seus componentes filhos por meio de props ou contexto.</p>
<p>Ao utilizar essa técnica, qualquer alteração no “estado pai de todos“ irá atualizar as props de todos os componentes filhos e sempre flui de forma de cima pra baixo, sempre sincronizado e nunca duplicado.</p>
<blockquote>
<p>No contexto do Forms, a nossa única fonte da verdade é o LayoutProvider.</p>
</blockquote>
<p><strong>Nota do autor</strong>: Ao desenvolver, não se pressione tanto para evitar o uso de estados locais. Em contra partida, foque em sempre fazer componentes stateless sempre que possível mas o estado de um componente existe para ser usado se você realmente precisar.</p>
<p>Para entender mais sobre Single Source of Truth: <a href="https://redux.js.org/introduction/three-principles#single-source-of-truth">https://redux.js.org/introduction/three-principles#single-source-of-truth</a></p></div></div><div class="chapter"><h1 style="font-size:50px">Boomerang effect</h1><div class="chapter-content"><h2 id="what-is-it" style="position:relative;"><a href="#what-is-it" aria-label="what is it permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is it?</h2>
<p><a href="https://github.com/matuzalemsteles/boomerang-effect">Boomerang effect</a> é um conceito "arquitetural" que divide os componentes da aplicação em pequenas partes, cada um com responsabilidades única com a idéia de compartilhar a mesma informação entre pequenas partes da aplicação (não confunda isso com uma store global), a reação do boomerang effect é causado pela composição de componentes consumidores que precisam da mesma informação e o provider que tem a responsabilidade de cuidar da informação e manipular se necessario.</p>
<p>Segindo a linha de raciocínio <code class="language-text">ComponentRenderer -&gt; Others Components -&gt; Provider</code>, esse comportamento é recomendando que siga se replicando pela estrutura da aplicação quando necessario, isso evita que muitos componentes dependem apenas de um Provider e diminui a responsabilidade dos Providers uma vez que você distribui a responsabilidade. Para se criar um boomerang effect tem algumas regras:</p>
<ul>
<li>Apenas crie a estrutura boomerang quando mais de um componente depender da mesma informação;</li>
<li>O Provedor não renderiza nenhum elemento apenas cuida da informação;</li>
</ul>
<h2 id="reaction" style="position:relative;"><a href="#reaction" aria-label="reaction permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reaction</h2>
<p>Para causar um efeito de reação bumerangue é quando o componente consumidor apenas renderiza os dados e quando os dados precisam ser alterados ele causa o efeito de propagação para o Provider e o Provider modifica e desce com as novas informações para os consumidores.</p>
<h2 id="communication" style="position:relative;"><a href="#communication" aria-label="communication permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Communication</h2>
<p>A comunicação do consumer para o Provider é feita via eventos "pub/sub", os consumidores envia eventos para o Provider (isso para evitar renderizações desnecessarias) e o provider pode enviar para todos os consumidores as novas informações, isso pode ser feito via pub para que chegue até os componentes sem causar renderizações a abaixo dos providers.</p>
<h2 id="forms-case" style="position:relative;"><a href="#forms-case" aria-label="forms case permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Forms case</h2>
<img src="/boomerang.png" />
<p>O caso do Forms segue apenas com um Provider que é o LayoutProvider, a Sidebar e o Form Builder são os componentes que precisam da mesma informação, por isso temos um Provider que manipula os dados e depois desce com esses novos dados para os dois lados (Sidebar e Form Builder).</p></div></div><div class="chapter"><h1 style="font-size:50px">Metal.js</h1><div class="chapter-content"><h1 id="what-is-it" style="position:relative;"><a href="#what-is-it" aria-label="what is it permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is it?</h1>
<p>Metal.js é uma biblioteca de Javascript para criação de componentes de frontend assim como um grande compilado de vários utilitários para lidar com a DOM e controlar estado(metal-state), eventos(metal-events) ou ajudar em construção de UIs difíceis(e.g metal-drag-drop). Existem vários utilitários disponíveis para várias coisas, incluindo URLs, routing. </p>
<h3 id="antes-de-começar" style="position:relative;"><a href="#antes-de-come%C3%A7ar" aria-label="antes de começar permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Antes de começar:</h3>
<p>Entretanto o projeto do Metal está em fase de <strong>manutenção/deprecação</strong>. Vários utilitários foram/estão sendo movidos para o código do DXP e issues dentro da própria biblioteca para criação de componentes só estão sendo fixados quando existe uma severidade muito grande.</p>
<h3 id="vamos-lá-como-assim-biblioteca-para-criar-componentes-de-frontend" style="position:relative;"><a href="#vamos-l%C3%A1-como-assim-biblioteca-para-criar-componentes-de-frontend" aria-label="vamos lá como assim biblioteca para criar componentes de frontend permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vamos lá, como assim biblioteca para criar componentes de frontend?</h3>
<p>O metal auxilia em fazer com que os componentes sejam atualizados assim que um dado é atualizado, de maneira geral, é uma forma de fazer two-way data binding.</p>
<p>Metal pode utilizar tanto Soy(Google Closure Templates) quanto JSX como linguagem de template.</p>
<p>Para entender mais sobre Soy, é recomendado a pasta de exemplos no repositório do closure-templates: <a href="https://github.com/google/closure-templates/tree/master/examples">closure-templates/examples at master · google/closure-templates · GitHub</a></p>
<p>Quando um dado é passado para o componente, o template renderiza somente as partes que realmente precisam ser atualizadas, o mecanismo que faz com que isso aconteça é o IncrementalDOM(<a href="https://google.github.io/incremental-dom/">incremental-dom | An in-place DOM diffing library</a>)</p>
<h3 id="incrementaldom" style="position:relative;"><a href="#incrementaldom" aria-label="incrementaldom permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IncrementalDOM</h3>
<p>O incrementalDOM é uma biblioteca para representar e aplicar modificações na DOM. O que acontece nele é que se faz uso de chamadas de Javascript para representar esses nós da arvore e a biblioteca faz com que aconteça a operação de diff, de maneira incremental, em cima da própria DOM, diferente do React que usa uma DOM em memória chamada virtualDOM.</p>
<p>O incrementalDOM não é utilizado de maneira direta. São usados várias ferramentas como metal-tools-soy e plugins de babel(no caso de JSX) para converter os templates em chamadas de incrementalDOM e a partir disso, o metal consegue interceptar e fazer mudanças em cima do IncrementalDOM.</p>
<p>Para saber mais sobre IncrementalDOM, veja o link a seguir:
<a href="https://google.github.io/incremental-dom/#why-incremental-dom">incremental-dom | An in-place DOM diffing library</a></p>
<h3 id="ciclo-de-vida" style="position:relative;"><a href="#ciclo-de-vida" aria-label="ciclo de vida permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ciclo de Vida</h3>
<p>Você provavelmente irá querer executar alguma coisa ou tratar seus dados no seu componente. Para isso, temos os ciclos de vida do metal.js, em que existem vários disponíveis e você pode encontrar mais informação aqui: <a href="http://metaljs.com/docs/guides/component-lifecycle.html">Component Lifecycle - Metal.js</a></p>
<h3 id="renderização" style="position:relative;"><a href="#renderiza%C3%A7%C3%A3o" aria-label="renderização permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Renderização</h3>
<p>Você pode usar as linguagens de template descritas acima, quanto você pode usar Javascript puro para renderizar componentes de Metal. Todos os componentes são instanciáveis, visto que são objetos e pode-se passar valores para esses num objeto de configuração como o exemplo abaixo:
<code class="language-text">new Modal(data, &#39;#parentElement&#39;);</code></p>
<p>Em que no primeiro argumento é o objeto citado(que foi chamado de <code class="language-text">data</code>) e o segundo é o seletor para o metal dar o replace no elemento da DOM existente e dar o bootstrap da aplicação.</p>
<p>Mais informações:
<a href="http://metaljs.com/docs/guides/rendering-components.html">Rendering Components - Metal.js</a></p>
<h3 id="eventos" style="position:relative;"><a href="#eventos" aria-label="eventos permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Eventos</h3>
<p>Eventos podem ser atachados a componentes de metal das 3 formas descritas no tutorial abaixo:</p>
<p><a href="http://metaljs.com/docs/guides/inline-events.html">Inline Events - Metal.js</a></p>
<h3 id="mais-informações" style="position:relative;"><a href="#mais-informa%C3%A7%C3%B5es" aria-label="mais informações permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mais informações</h3>
<p>Para mais informações sobre Metal, acesse a seguinte documentação:</p>
<p><a href="http://metaljs.com/docs/guides/">http://metaljs.com/docs/guides/</a></p>
<p>Para informações sobre utilitários ou como saber como o metal.js funciona internamente, você pode acessar a seguinte URL: </p>
<p><a href="https://github.com/metal/metal-training/tree/master/docs/metal.js">https://github.com/metal/metal-training/tree/master/docs/metal.js</a></p></div></div><div class="chapter"><h1 style="font-size:50px">Form Renderer</h1><div class="chapter-content"><h1 id="what-is-it" style="position:relative;"><a href="#what-is-it" aria-label="what is it permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What is it?</h1></div></div><div class="chapter"><h1 style="font-size:50px">Layout Provider</h1><div class="chapter-content"><h1 id="localização" style="position:relative;"><a href="#localiza%C3%A7%C3%A3o" aria-label="localização permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Localização</h1>
<p>O LayoutProvider se localiza no módulo do <code class="language-text">dynamic-data-mapping-form-builder</code> mas é aplicado em todas as aplicações que estão usando o Forms.</p>
<h1 id="o-que-resolve" style="position:relative;"><a href="#o-que-resolve" aria-label="o que resolve permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>O que resolve?</h1>
<p>Basicamente é o componente pai comum a todos, como exemplos de filhos temos o FormBuilder, RuleBuilder, FormRenderer, que tem responsabilidade de armazenar a fonte única da verdade da aplicação e também de ter implementado como que uma determinada ação disparada em qualquer parte da aplicação irá persistir os dados nessa store.</p>
<p>Para isso, se faz o uso de visitors(iremos falar mais sobre isso na parte de <a href="#visitors">Visitors</a>) como função de apoio para obter dados da estrutura do Forms e persistir-los.</p>
<h1 id="como-funciona-a-integração-do-form-builder-com-a-user-view" style="position:relative;"><a href="#como-funciona-a-integra%C3%A7%C3%A3o-do-form-builder-com-a-user-view" aria-label="como funciona a integração do form builder com a user view permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Como funciona a integração do Form Builder com a User View?</h1>
<p>Como já foi abordado anteriormente, o Form Builder é responsável para criar estruturas para serem renderizadas usando o User View, mas como isso acontece?</p>
<p>No Forms, é seguido o padrão de Redux em que existem ações como <code class="language-text">fieldAdded</code> que partindo da Sidebar(Builder) fala para a store do Forms(LayoutProvider) que um field novo foi adicionado em determinada região e o valor é atualizado no User View.</p>
<p>Como por exemplo:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">dispatch</span><span class="token punctuation">(</span>
  ‘fieldAdded’’<span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    pageIndex<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    rowIndex<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    columnIndex<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    fieldType<span class="token operator">:</span> ‘text’
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Enquanto no Layout Provider, ele recebe dados vindo dessa ação da seguinte forma:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>‘fieldAdded’<span class="token punctuation">,</span> <span class="token parameter">payload</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>pages<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>pageIndex<span class="token punctuation">,</span> rowIndex<span class="token punctuation">,</span> columnIndex<span class="token punctuation">,</span> fieldType<span class="token punctuation">}</span> <span class="token operator">=</span> payload<span class="token punctuation">;</span>

    <span class="token comment">// Realiza a operação de adicionar um field no local especificado pelo evento</span>
    pages<span class="token punctuation">[</span>pageIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>rows<span class="token punctuation">[</span>rowIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>columns<span class="token punctuation">[</span>columnIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">createField</span><span class="token punctuation">(</span>fieldType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Atualiza estado da aplicação. Isso faz com que haja uma renderização da aplicação e o novo field deverá aparecer no Form Builder</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>pages<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>Isso fará com que o a função de handling do evento para a ação desejada seja acionado dentro do LayoutProvider provocando assim uma alteração de estado da store.</p>
<p>No Forms, existem várias ações disponíveis, esses são alguns exemplos de ações disponíveis no LayoutProvider:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">activePageUpdated
columnResized
elementSetAdded
fieldAdded
fieldBlurred
fieldChangesCanceled
fieldClicked
fieldDeleted
fieldDuplicated
fieldEdited
fieldHovered
fieldMoved
fieldSetAdded
focusedFieldEvaluationEnded
languageIdDeleted
pageAdded
pageDeleted
pageReset
pagesSwapped
pagesUpdated
paginationItemClicked
paginationModeUpdated
paginationNextClicked
paginationPreviousClicked
ruleAdded
ruleDeleted
ruleEdited
ruleSaved
ruleValidatorChanged
sectionAdded
sidebarFieldBlurred
successPageChanged</code></pre></div>
<p>Veja <a href="https://github.com/liferay/liferay-portal/blob/master/modules/apps/dynamic-data-mapping/dynamic-data-mapping-form-builder/src/main/resources/META-INF/resources/js/components/LayoutProvider/LayoutProvider.es.js#L84">https://github.com/liferay/liferay-portal/blob/master/modules/apps/dynamic-data-mapping/dynamic-data-mapping-form-builder/src/main/resources/META-INF/resources/js/components/LayoutProvider/LayoutProvider.es.js#L84</a> para mais exemplos.</p></div></div><div class="chapter"><h1 style="font-size:50px">Form Builder e Sidebar</h1><div class="chapter-content"><h1 id="form-builder" style="position:relative;"><a href="#form-builder" aria-label="form builder permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Form Builder</h1>
<p>O FormBuilder é composto do FormRenderer e o PageRenderer.</p>
<p>O FormRenderer é a parte que lida com o modo de renderização do Form Builder, como se vai ter páginas ou não, se tiver, como essas páginas irão ser mostradas(Pagination, Wizard, Tabbed, Grid). Existem mais detalhes sobre esse componente na parte de FormRenderer.
￼</p>
<h1 id="sidebar" style="position:relative;"><a href="#sidebar" aria-label="sidebar permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sidebar</h1>
<p>O componente de Sidebar também utiliza o Form Renderer, ele é usado na parte de configuração dos fields para que se reuse os mesmos fields.</p>
<p>A Sidebar é um componente do Forms em que dentro dele existem lógicas para fazer o drag-n-drop dos fields, emissão de eventos para o LayoutProvider para alteração na estrutura do formulário. Como por exemplo o <code class="language-text">settingsContext</code> que tem informações que descreve como um determinado field deve ser mostrado.</p>
<h1 id="como-alterações-na-sidebar-fazem-os-fields-dentro-do-form-builder-serem-modificados" style="position:relative;"><a href="#como-altera%C3%A7%C3%B5es-na-sidebar-fazem-os-fields-dentro-do-form-builder-serem-modificados" aria-label="como alterações na sidebar fazem os fields dentro do form builder serem modificados permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Como alterações na Sidebar fazem os fields dentro do Form Builder serem modificados?</h1>
<p>Primeiramente, é importante salientar que Sidebar e Form Builder são componentes irmãos e eles não se comunicam de maneira direta. A única coisa que compartilham é o LayoutProvider e é por ele que eles fazem alterações na estrutura do Formulário e a partir disso um muda o outro.</p>
<p>Para qualquer mudança dentro de um field dentro do FormBuilder,  é emitido um evento de <code class="language-text">fieldEdited</code>, <code class="language-text">fieldBlurred</code> ou <code class="language-text">fieldFocused</code> para o
LayoutProvider e com isso a Sidebar consegue escutar as mudanças e vice e versa.</p></div></div><div class="chapter"><h1 style="font-size:50px">Fields</h1><div class="chapter-content"><h1 id="fields" style="position:relative;"><a href="#fields" aria-label="fields permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fields</h1>
<p>Fields são a parte mais fundamental de um formulário. Dentro desses componentes existem lógicas para tratar os casos de uso designados a eles e também a maneira de como se comunicam com o contexto do Forms.</p>
<p>Essa comunicação é dada emitindo eventos para o provedor mais próximo(como o PageRenderer ou o FormRenderer) que irá repassar para ao LayoutProvider.</p>
<h1 id="fieldbase" style="position:relative;"><a href="#fieldbase" aria-label="fieldbase permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FieldBase</h1>
<p>O FieldBase é um componente "pai-genérico-comum" de um field em que é renderizado partes comuns a todos os fields, como elementos e lógicas de validação e lógicas para tornar o field “repetitivo/removível”, se o field precisa ser preenchido obrigatoriamente.</p></div></div><div class="chapter"><h1 style="font-size:50px">Visitors</h1><div class="chapter-content"><h1 id="visitors" style="position:relative;"><a href="#visitors" aria-label="visitors permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Visitors</h1>
<h2 id="o-que-resolvem" style="position:relative;"><a href="#o-que-resolvem" aria-label="o que resolvem permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>O que resolvem?</h2>
<p>De acordo com a nossa amada <a href="https://en.wikipedia.org/wiki/Visitor_pattern">Wikipédia</a>, esse padrão foi criado para fazer operacões em cima de elementos dentro de uma estrutura de um objeto.</p>
<p>No Forms eles são utilizados para percorrer partes da estrutura de dados do Forms como iterar em cima de Páginas(<code class="language-text">mapPages</code>), sobre linhas(<code class="language-text">mapRows</code>), verificar se existe um determinado field, filtrar fields para se aplicar uma determinada regra entre outras operações.</p>
<p>Para ver mais sobre o que conseguimos fazer com visitors, acesse <a href="https://github.com/liferay/liferay-portal/blob/master/modules/apps/dynamic-data-mapping/dynamic-data-mapping-form-renderer/src/main/resources/META-INF/resources/js/util/visitors.es.js#L17">https://github.com/liferay/liferay-portal/blob/master/modules/apps/dynamic-data-mapping/dynamic-data-mapping-form-renderer/src/main/resources/META-INF/resources/js/util/visitors.es.js#L17</a>.</p></div></div></main><footer>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-a11bf876fdf1e027fbc6.js"],"component---src-components-chapter-js":["/component---src-components-chapter-js-9f1293cc0076c64480c3.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0ebcf1327e0fd8b9bed9.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ee47f98d5429b2dd3b85.js"]};/*]]>*/</script><script src="/lfr-forms-docs/component---src-pages-index-js-ee47f98d5429b2dd3b85.js" async=""></script><script src="/lfr-forms-docs/commons-41607989188aa9047a31.js" async=""></script><script src="/lfr-forms-docs/styles-36681512479a843831b0.js" async=""></script><script src="/lfr-forms-docs/app-a11bf876fdf1e027fbc6.js" async=""></script><script src="/lfr-forms-docs/framework-624f79e66261973aaa49.js" async=""></script><script src="/lfr-forms-docs/webpack-runtime-5c83b0c36b95088ee901.js" async=""></script></body></html>